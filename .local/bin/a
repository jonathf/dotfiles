#!/usr/bin/env bash

if ! git rev-parse --is-inside-work-tree >/dev/null 2>&1; then
    extra_args1="--git-dir=$HOME/.config/dotfiles --work-tree=$HOME"
    extra_args2="--force"
fi
if [[ -z "$@" ]]; then
    files=$(git $extra_args ls-files -m | uniq)
    if [[ -z "$files" ]]; then
        echo "Nothing to add"
        exit
    fi
    echo $files | sed -e 's/ /\n/g'
    read -p "  add file(s)? [yN]" -n 1 -r
    if [[ $REPLY =~ ^[yY]$ ]]; then
        git $extra_args1 add $extra_args2 $files
    fi
else
    git $extra_args1 add $extra_args2 "$@"
fi
